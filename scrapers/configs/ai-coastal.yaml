# AI Scraper Config: Coastal Pet
# Problematic site with JS rendering and complex product variants
name: "ai-coastal"
display_name: "AI Coastal Pet Product Extractor"
base_url: "https://www.coastalpet.com"
scraper_type: "agentic"

# Problem indicators from static scraper:
# - js_rendered: Dynamic content with product variants
# - selector_breakage: Complex selectors for size/variant buttons
# - Cookie consent handling required
# - Salsify image CDN with complex URLs

ai_config:
  tool: "browser-use"
  task: "Find the exact Coastal Pet product for the SKU/model number and extract product name, brand, size options, description, images, price, UPC, and item number. Handle cookie consent and product variant selection."
  max_steps: 10
  confidence_threshold: 0.7
  llm_model: "gpt-4o-mini"
  use_vision: true
  headless: true

workflows:
  - action: "navigate"
    name: "search_coastal_pet_for_sku"
    params:
      url: "https://www.coastalpet.com/products/search/?q={sku}"

  - action: "click"
    name: "click_first_result"
    params:
      selector: "a.product-listing__title.product-listing__link"

  - action: "ai_extract"
    name: "extract_coastal_pet_product"
    params:
      task: "Open the best Coastal Pet product page, handle cookie consent if needed, then extract Name, Brand, Size Options, Description, Images, Price, UPC, and Item Number. Coastal Pet specializes in collars, leashes, and pet accessories."
      visit_top_n: 2
      max_steps: 14
      confidence_threshold: 0.7
      schema:
        name: str
        brand: str
        size_options: list
        description: str
        images: list
        price: str
        upc: str
        item_number: str

  - action: "ai_validate"
    name: "validate_coastal_pet_extraction"
    params:
      required_fields:
        - name
        - brand
        - images
      sku_must_match: false
      min_confidence: 0.65

test_skus:
  - "879213007157"

fake_skus:
  - "xyzabc123notexist456"
  - "ZZZZZ"
  - "00000"

edge_case_skus:
  - "A"
  - "ABCDEFGHIJ123456"

timeout: 60
retries: 0

anti_detection:
  enable_captcha_detection: false
  enable_rate_limiting: true
  enable_human_simulation: true
  enable_session_rotation: false
  enable_blocking_handling: false
  rate_limit_min_delay: 2.0
  rate_limit_max_delay: 4.0
  session_rotation_interval: 30
  max_retries_on_detection: 2

validation:
  no_results_selectors:
    - "h3:has-text('Search')"
  no_results_text_patterns:
    - "Your search returned no results"
    - "0 Products Found"

# Success criteria for PoC:
# - Target: >80% extraction success rate
# - Target: <$0.08 per page cost
# - Fallback: Traditional scraper if AI fails 2x
